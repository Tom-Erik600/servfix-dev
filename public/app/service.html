<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Air-Tech AS - Service</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/service.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="toast-container"></div>

    <div id="loading-indicator" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"><div class="spinner"></div><p>Laster service...</p></div>
    </div>

    <div class="app-container">
        <header class="app-header" id="app-header">
    <a href="orders.html?id=${state.orderId}" class="header-nav-button" title="Tilbake">â€¹</a>
    <div class="header-main-content">
        <div class="logo-circle">
            <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="14" stroke="white" stroke-width="2" fill="none"/><circle cx="16" cy="16" r="8" stroke="white" stroke-width="2" fill="none"/><circle cx="16" cy="16" r="3" fill="white"/><path d="M16 2 L16 8" stroke="white" stroke-width="2"/><path d="M16 24 L16 30" stroke="white" stroke-width="2"/><path d="M30 16 L24 16" stroke="white" stroke-width="2"/><path d="M8 16 L2 16" stroke="white" stroke-width="2"/></svg>
        </div>
        <div class="company-info">
            <h1>AIR-TECH AS</h1>
            <span class="app-subtitle">Service gjennomfÃ¸ring</span>
        </div>
    </div>
    <div class="header-user-info">
        <span id="technician-initials"></span>
        <span id="current-date"></span>
    </div>
</header>
        
        <main class="main-content">
            <div id="anlegg-info" class="customer-section"></div>
            
            <div id="component-list" class="checklist-card">
                <h4 class="card-title">System/Sjekklister</h4>
                <div id="component-list-container"><p class="placeholder-text">Ingen sjekklister er lagret.</p></div>
            </div>

            <div id="new-component-form" class="component-form-section">
                <form id="component-form">
                    <h4 class="card-title" id="form-title">Sjekkliste system</h4>
                    <div id="component-details-form"></div>
                    <h4 class="card-title" style="margin-top:16px; font-size: 14px;">Sjekkpunkter</h4>
                    <div id="checklist-items-container"><p class="placeholder-text">Laster sjekkliste...</p></div>
                    
                    <div id="products-section-container" class="dynamic-section" style="display: none;">
                        <div class="checklist-card">
                            <div class="dynamic-section-header">
                                <h4 class="card-title">Produkter</h4>
                                <button type="button" class="add-line-btn-icon" data-action="add-product-line">+</button>
                            </div>
                            <div id="product-lines-container" class="line-item-container"></div>
                        </div>
                    </div>

                    <div id="additional-work-section-container" class="dynamic-section" style="display: none;">
                        <div class="checklist-card">
                            <div class="dynamic-section-header">
                                <h4 class="card-title">Tilleggsarbeid</h4>
                                <button type="button" class="add-line-btn-icon" data-action="add-work-line">+</button>
                            </div>
                            <div id="additional-work-lines-container" class="line-item-container"></div>
                        </div>
                    </div>

                    <div id="drift-schedule-container" class="dynamic-section"></div>

                    <button type="submit" class="action-btn primary" style="width:100%; margin-top:16px;">
                        <i data-lucide="save"></i> <span id="save-btn-text">Lagre sjekkliste</span>
                    </button>
                </form>
            </div>

            <div id="overall-comment-section" class="checklist-card" style="display:none;">
                <h4 class="card-title">Ã˜vrige kommentarer til rapport</h4>
                <textarea id="overall-comment" rows="4" placeholder="Generelle kommentarer til hele servicen..."></textarea>
            </div>

            <div id="attachments-section" class="checklist-card" style="display:none;">
    <h4 class="card-title">Bilder til rapport</h4>
    <div id="attachments-container">
        <div class="empty-gallery">
            <div class="empty-icon">ðŸ“·</div>
            <div>Ingen rapport-bilder lagt til</div>
        </div>
    </div>
    <div class="photo-dropdown-wrapper" style="position: relative; display: inline-block;">
        <button type="button" class="photo-btn" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 12px; background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%); color: white; border: none; border-radius: 6px; font-size: 13px; cursor: pointer;">
            <i data-lucide="camera"></i>Ta bilde<i data-lucide="chevron-down" style="width: 12px; height: 12px; margin-left: 4px;"></i>
        </button>
        <div class="photo-dropdown" style="position: absolute; top: 100%; left: 0; background: white; border: 1px solid #ddd; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 1000; opacity: 0; visibility: hidden; min-width: 180px;">
            <button class="photo-option" data-action="camera" style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border: none; background: none; width: 100%; text-align: left; font-size: 13px; cursor: pointer;"><i data-lucide="camera"></i>Ta bilde med kamera</button>
            <button class="photo-option" data-action="upload" style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; border: none; background: none; width: 100%; text-align: left; font-size: 13px; cursor: pointer;"><i data-lucide="upload"></i>Last opp fil</button>
        </div>
    </div>
</div>

            <footer class="page-footer" id="page-footer">
                <button type="button" class="action-btn green-btn" id="finalize-report-btn">
                    <i data-lucide="check-circle"></i> Ferdigstill Anlegg
                </button>
            </footer>
        </main>
    </div>

    <!-- Auth check fÃ¸rst -->
    <script src="./assets/js/auth-check.js"></script>

    <script src="assets/js/app.js"></script>
<script src="assets/js/service.js"></script>
<script src="assets/js/photo-improvement.js"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<script>lucide.createIcons();</script>
</body>
</html>